version: '1.0.{build}'

notifications:
  - provider: Email
    to:
      - kwl3434@gmail.com
    on_build_success: true
    on_build_failure: true
    on_build_status_changed: true  
   
environment:
  CMAKE_BUILD_TYPE: Release
  QT5_DIR: C:/Qt/5.14.2/msvc2017_64/bin
  APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017
  CMAKE_GENERATOR: Visual Studio 15 2017 Win64
  # vcpkg disabled 
  # CMAKE_TOOLCHAIN_FILE: c:/tools/vcpkg/scripts/buildsystems/vcpkg.cmake
  # VCPKG_TARGET_TRIPLET: x64-windows 
  matrix:
    - PYTHON_EXECUTABLE: C:/Python38-x64/python.exe 
      DEFAULT_ENABLED: true  
    - PYTHON_EXECUTABLE: C:/Python37-x64/python.exe 
      DEFAULT_ENABLED: true  
    - PYTHON_EXECUTABLE: C:/Python36-x64/python.exe 
      DEFAULT_ENABLED: true     
  
# vcpkg disabled
# cache: c:\tools\vcpkg\installed\  
  
# 
#if you need to debug uncomment these lines (see https://www.appveyor.com/docs/how-to/rdp-to-build-worker/)
#init:
#  - ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
#
#on_finish:
#  - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

init:
  - ps: | 
      If ($env:APPVEYOR_REPO_TAG -eq "false" -and $env:DEFAULT_ENABLED -eq "false") {
        Write-Host "Skipping build"
        Exit-AppveyorBuild
      }   
build_script:
  - cmd: choco install -y --allow-empty-checksums swig 
  - cmd: cd %APPVEYOR_BUILD_FOLDER% 
  - cmd: git clone https://github.com/google/googletest/ ./lib/googletest
  - cmd: cd ./lib/googletest
  - cmd: cmake . -Dgtest_force_shared_crt=ON
  - cmd: cd %APPVEYOR_BUILD_FOLDER% 
  - cmd: cmake . -DCMAKE_BUILD_TYPE=Release
  - cmd: cmake --build build
  

test: off
